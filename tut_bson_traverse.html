<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>libmongo-client: Traversing BSON objects</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libmongo-client
   &#160;<span id="projectnumber">0.1.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorial.html">Tutorial</a></li><li class="navelem"><a class="el" href="tut_bson.html">Working with BSON objects</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Traversing BSON objects </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Now that we can build BSON objects (see the <a class="el" href="tut_bson_build.html">previous section</a>), it is time that we learn how to find things in them!</p>
<p>We will use the same JSON structure as in the previous example.</p>
 First, we include our stuff, and create a function that gives us a BSON object to work with: <div class="fragment"><div class="line"><span class="preprocessor">#include &lt;mongo.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"></div>
<div class="line">bson *</div>
<div class="line">tut_bson (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">  bson *b;</div>
<div class="line"></div>
<div class="line">  b = <a class="code" href="group__bson__object__access.html#ga5bec2a5276b310191f94ba193a024fcb">bson_build_full</a></div>
<div class="line">    (<a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba83acce0871337a68a22c7c9d7b8c5c4a">BSON_TYPE_STRING</a>, <span class="stringliteral">&quot;author&quot;</span>, FALSE, <span class="stringliteral">&quot;Gergely Nagy&quot;</span>, -1,</div>
<div class="line">     <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba248510c62bbfddd812265ef599d15fd7">BSON_TYPE_ARRAY</a>, <span class="stringliteral">&quot;pages&quot;</span>, TRUE,</div>
<div class="line">       <a class="code" href="group__bson__object__access.html#ga5bec2a5276b310191f94ba193a024fcb">bson_build_full</a> (<a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba0d25e0e5ffcd3b598ed1893bb2581234">BSON_TYPE_DOCUMENT</a>, <span class="stringliteral">&quot;1&quot;</span>, TRUE,</div>
<div class="line">                        <a class="code" href="group__bson__object__access.html#gae017cba3a7c5a49981aae92ff26d1ed8">bson_build</a> (<a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba83acce0871337a68a22c7c9d7b8c5c4a">BSON_TYPE_STRING</a>, <span class="stringliteral">&quot;title&quot;</span>, <span class="stringliteral">&quot;BSON tutorial&quot;</span>, -1,</div>
<div class="line">                                    <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba83acce0871337a68a22c7c9d7b8c5c4a">BSON_TYPE_STRING</a>, <span class="stringliteral">&quot;content&quot;</span>, <span class="stringliteral">&quot;...&quot;</span>, -1,</div>
<div class="line">                                    <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba9a106beacbbedfec723680af06b44bbc">BSON_TYPE_INT32</a>, <span class="stringliteral">&quot;importance&quot;</span>, 1,</div>
<div class="line">                                    <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba8da6f27ef8afcaac44402b61731a05df">BSON_TYPE_NONE</a>),</div>
<div class="line">                        <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba0d25e0e5ffcd3b598ed1893bb2581234">BSON_TYPE_DOCUMENT</a>, <span class="stringliteral">&quot;2&quot;</span>, TRUE,</div>
<div class="line">                        <a class="code" href="group__bson__object__access.html#gae017cba3a7c5a49981aae92ff26d1ed8">bson_build</a> (<a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba83acce0871337a68a22c7c9d7b8c5c4a">BSON_TYPE_STRING</a>, <span class="stringliteral">&quot;title&quot;</span>, <span class="stringliteral">&quot;Some other thing&quot;</span>, -1,</div>
<div class="line">                                    <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba83acce0871337a68a22c7c9d7b8c5c4a">BSON_TYPE_STRING</a>, <span class="stringliteral">&quot;content&quot;</span>, <span class="stringliteral">&quot;...&quot;</span>, -1,</div>
<div class="line">                                    <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba9a106beacbbedfec723680af06b44bbc">BSON_TYPE_INT32</a>, <span class="stringliteral">&quot;importance&quot;</span>, 0,</div>
<div class="line">                                    <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba8da6f27ef8afcaac44402b61731a05df">BSON_TYPE_NONE</a>),</div>
<div class="line">                        <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba8da6f27ef8afcaac44402b61731a05df">BSON_TYPE_NONE</a>),</div>
<div class="line">     <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cbad60fbf033900d76f926b09790318c4f6">BSON_TYPE_BOOLEAN</a>, <span class="stringliteral">&quot;inline&quot;</span>, FALSE, TRUE,</div>
<div class="line">     <a class="code" href="group__bson__types.html#ggadac27a93ef69dbe56a6409c68395e5cba8da6f27ef8afcaac44402b61731a05df">BSON_TYPE_NONE</a>);</div>
<div class="line">  <a class="code" href="group__bson__object__access.html#gaa9919014ef9d2e2c1b04efa31e0f2124">bson_finish</a> (b);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> b;</div>
<div class="line">}</div>
</div><!-- fragment --></p>
<p><div class="fragment"><div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main (<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
</div><!-- fragment --> First, we need a variable to hold our BSON object, and a cursor, with which we can find the keys we're looking for. <div class="fragment"><div class="line">  bson *doc;</div>
<div class="line">  bson_cursor *c, *c_arr, *c_page;</div>
</div><!-- fragment --></p>
<p>Then we need a few variables to store the retrieved information in. Extracting data out of a BSON object involves storing them in a variable of our own. <div class="fragment"><div class="line"></div>
<div class="line">  bson *v_doc, *v_array;</div>
<div class="line">  gboolean v_bool;</div>
<div class="line">  <span class="keyword">const</span> gchar *v_str;</div>
</div><!-- fragment --></p>
<p><div class="fragment"><div class="line"></div>
<div class="line">  doc = tut_bson ();</div>
</div><!-- fragment --></p>
<p>In order to find something in a BSON object, we must know the keys name. There's two ways to find information within a BSON object: <a class="el" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb" title="Create a new cursor positioned at a given key. ">bson_find()</a> and <a class="el" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c" title="Position the cursor to the next key. ">bson_cursor_next()</a> and its friends.</p>
<p>The first takes a BSON object, and returns a cursor that points to the key we wanted to find (or to NULL, if it was not found, of course). We can then extract that value, and either close the cursor, or use <a class="el" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c" title="Position the cursor to the next key. ">bson_cursor_next()</a> to iterate over the rest of the keys.</p>
<p>The advantage of <a class="el" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb" title="Create a new cursor positioned at a given key. ">bson_find()</a> is that we can jump to a specific key easily, but at the cost of having to use a new cursor every time, which in turn will start searching from the beginning of a BSON document.</p>
<p>On the other hand, <a class="el" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c" title="Position the cursor to the next key. ">bson_cursor_next()</a> remembers its position, and jumping to the next key is straightforward. It can also be used in conjunction with <a class="el" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb" title="Create a new cursor positioned at a given key. ">bson_find()</a> to locate the first key we're interested in, and move on to the next until we're done.</p>
<p>For our first traversal example, lets say we want to see who the author of our BSON object is! We can extract that information by locating the "author" key, and retrieving the string contents: <div class="fragment"><div class="line"></div>
<div class="line">  c = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (doc, <span class="stringliteral">&quot;author&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga657fb2f0fecd190b824d3e38936b1d4d">bson_cursor_get_string</a> (c, &amp;v_str);</div>
<div class="line">  printf (<span class="stringliteral">&quot;Author: %s\n&quot;</span>, v_str);</div>
</div><!-- fragment --></p>
<p>Now, if we also want to know whether the 'inline' key is set to true or false, we have two options: if we know the exact order of keys, we can use the appropriate amount of <a class="el" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c" title="Position the cursor to the next key. ">bson_cursor_next()</a> calls: <div class="fragment"><div class="line"></div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c">bson_cursor_next</a> (c);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c">bson_cursor_next</a> (c);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga25d4336571d2954b22ef3bbfb9b53c4e">bson_cursor_get_boolean</a> (c, &amp;v_bool);</div>
<div class="line">  printf (<span class="stringliteral">&quot;inline: %s\n&quot;</span>, (v_bool) ? <span class="stringliteral">&quot;TRUE&quot;</span> : <span class="stringliteral">&quot;FALSE&quot;</span>);</div>
</div><!-- fragment --></p>
<p>But this is not only ugly, it's very sensitive to the order of the keys, and it's hard to understand aswell, without being familiar with the document's structure.</p>
<p>So, while it is a little more inconvenient, it's better to find the key in some other way. But first, let's close our cursor, as we'll need to start again anyway... <div class="fragment"><div class="line"></div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c);</div>
</div><!-- fragment --></p>
<p>First, we'll go the easy route, and use <a class="el" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb" title="Create a new cursor positioned at a given key. ">bson_find()</a>: <div class="fragment"><div class="line"></div>
<div class="line">  c = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (doc, <span class="stringliteral">&quot;author&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga657fb2f0fecd190b824d3e38936b1d4d">bson_cursor_get_string</a> (c, &amp;v_str);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c);</div>
<div class="line">  c = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (doc, <span class="stringliteral">&quot;inline&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga25d4336571d2954b22ef3bbfb9b53c4e">bson_cursor_get_boolean</a> (c, &amp;v_bool);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c);</div>
<div class="line"></div>
<div class="line">  printf (<span class="stringliteral">&quot;Author: %s; inline: %s; (bson_find)\n&quot;</span>,</div>
</div><!-- fragment --></p>
<p>Now, the downside of this, is that we ran through the BSON object twice. Well, once and a little, since the "author" key was the first. But using <a class="el" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb" title="Create a new cursor positioned at a given key. ">bson_find()</a> this way has the potential of traversing through a document multiple times.</p>
<p>Now, if we know the one key always comes after another, then we can use <a class="el" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c" title="Position the cursor to the next key. ">bson_cursor_next()</a> to help us find it, without having to restart from the beginning. We do this by extracting the key name from the cursor, and comparing it to whatever we're searching for: <div class="fragment"><div class="line">          v_str, (v_bool) ? <span class="stringliteral">&quot;TRUE&quot;</span> : <span class="stringliteral">&quot;FALSE&quot;</span>);</div>
<div class="line"></div>
<div class="line">  c = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (doc, <span class="stringliteral">&quot;author&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga657fb2f0fecd190b824d3e38936b1d4d">bson_cursor_get_string</a> (c, &amp;v_str);</div>
<div class="line">  <span class="keywordflow">while</span> (<a class="code" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c">bson_cursor_next</a> (c))</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> (strcmp (<a class="code" href="group__bson__cursor.html#ga8de19693c54fca2eb6c8a4f5a30eb637">bson_cursor_key</a> (c), <span class="stringliteral">&quot;inline&quot;</span>) == 0)</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="group__bson__cursor.html#ga25d4336571d2954b22ef3bbfb9b53c4e">bson_cursor_get_boolean</a> (c, &amp;v_bool);</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c);</div>
<div class="line"></div>
<div class="line">  printf (<span class="stringliteral">&quot;Author: %s; inline: %s; (bson_cursor_next)\n&quot;</span>,</div>
</div><!-- fragment --></p>
<p>Now the above is still picky about key order, but it's at least more flexible: we can put any number of keys between author and inline, and it will work. In most cases, that's good enough. In every other case, where we have no idea about key ordering, <a class="el" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb" title="Create a new cursor positioned at a given key. ">bson_find()</a> is still there for us.</p>
<p>Even better, the library itself provides a function that does something similar: it takes a cursor and a key name, and attempts to find the key past the cursor's current position. So if we already have the author, we can use this function to find the next inline key aswell: <div class="fragment"><div class="line">          v_str, (v_bool) ? <span class="stringliteral">&quot;TRUE&quot;</span> : <span class="stringliteral">&quot;FALSE&quot;</span>);</div>
<div class="line"></div>
<div class="line">  c = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (doc, <span class="stringliteral">&quot;author&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga657fb2f0fecd190b824d3e38936b1d4d">bson_cursor_get_string</a> (c, &amp;v_str);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga1655fa3c1116657f42e4cf76ec8ca129">bson_cursor_find_next</a> (c, <span class="stringliteral">&quot;inline&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga25d4336571d2954b22ef3bbfb9b53c4e">bson_cursor_get_boolean</a> (c, &amp;v_bool);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c);</div>
<div class="line"></div>
<div class="line">  printf (<span class="stringliteral">&quot;Author: %s; inline: %s; (bson_cursor_find_next)\n&quot;</span>,</div>
</div><!-- fragment --></p>
<p>However, if we suspect that a key might come after the current position, but we're not sure, and still want to find the key with as little code as possible, we shall not despair! The <a class="el" href="group__bson__cursor.html#gab9c63d49d46c04b2e5ffbdd9d9ee12d9" title="Move the cursor to a given key. ">bson_cursor_find()</a> function does just that: it will try to find the key starting from the current position, and wrap over once if it can't.</p>
<p>Lets see how it works! First, we find a key in the middle: <div class="fragment"><div class="line">          v_str, (v_bool) ? <span class="stringliteral">&quot;TRUE&quot;</span> : <span class="stringliteral">&quot;FALSE&quot;</span>);</div>
<div class="line"></div>
<div class="line">  c = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (doc, <span class="stringliteral">&quot;pages&quot;</span>);</div>
</div><!-- fragment --></p>
<p>Now that we have a key in the middle, lets find a key after it: <div class="fragment"><div class="line">  <a class="code" href="group__bson__cursor.html#gab9c63d49d46c04b2e5ffbdd9d9ee12d9">bson_cursor_find</a> (c, <span class="stringliteral">&quot;inline&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga25d4336571d2954b22ef3bbfb9b53c4e">bson_cursor_get_boolean</a> (c, &amp;v_bool);</div>
</div><!-- fragment --></p>
<p>And once we have that - and we're at the end of our BSON object -, lets try finding the author key aswell: <div class="fragment"><div class="line">  <a class="code" href="group__bson__cursor.html#gab9c63d49d46c04b2e5ffbdd9d9ee12d9">bson_cursor_find</a> (c, <span class="stringliteral">&quot;author&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga657fb2f0fecd190b824d3e38936b1d4d">bson_cursor_get_string</a> (c, &amp;v_str);</div>
</div><!-- fragment --></p>
<p>That works, just like that! To verify, we go ahead and print the results, which should be the same as it was in the previous examples:</p>
<p><div class="fragment"><div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c);</div>
</div><!-- fragment --></p>
<p><div class="fragment"><div class="line"></div>
<div class="line">  printf (<span class="stringliteral">&quot;Author: %s; inline: %s; (bson_cursor_find)\n&quot;</span>,</div>
</div><!-- fragment --></p>
<p>One thing we did not explore yet, is <a class="el" href="group__bson__cursor.html#gadcac4b9c2076afa5e7e656baed077b18" title="Create a new cursor. ">bson_cursor_new()</a>: this will create a new cursor, and point to to the very beginning of our BSON object, just before the first key. Thus, the first <a class="el" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c" title="Position the cursor to the next key. ">bson_cursor_next()</a> done afterwards will yield the first key. <div class="fragment"><div class="line">          v_str, (v_bool) ? <span class="stringliteral">&quot;TRUE&quot;</span> : <span class="stringliteral">&quot;FALSE&quot;</span>);</div>
<div class="line"></div>
<div class="line">  c = <a class="code" href="group__bson__cursor.html#gadcac4b9c2076afa5e7e656baed077b18">bson_cursor_new</a> (doc);</div>
<div class="line">  <span class="keywordflow">while</span> (<a class="code" href="group__bson__cursor.html#ga88ecba6bdfb9c33a7945daddb5bcab5c">bson_cursor_next</a> (c))</div>
<div class="line">    {</div>
<div class="line">      printf (<span class="stringliteral">&quot;Key: %s; type=%s\n&quot;</span>, <a class="code" href="group__bson__cursor.html#ga8de19693c54fca2eb6c8a4f5a30eb637">bson_cursor_key</a> (c),</div>
<div class="line">              <a class="code" href="group__bson__cursor.html#ga7ec76513b2377a122ed2a95ffa1042c4">bson_cursor_type_as_string</a> (c));</div>
<div class="line">    }</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c);</div>
</div><!-- fragment --></p>
<p>Very well! But what if we want to see the title of the second page within the pages array? Unfortunately, that is a bit more work to accomplish: we'll need to extract the pages array from our document, and then extract its second element, and then we can find stuff in that: <div class="fragment"><div class="line"></div>
<div class="line">  c = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (doc, <span class="stringliteral">&quot;pages&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga92fec73041e5d7efaf9899c5b6d37343">bson_cursor_get_array</a> (c, &amp;v_array);</div>
<div class="line">  c_arr = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (v_array, <span class="stringliteral">&quot;2&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga6f8c5f012e5236e18d677142b49262fb">bson_cursor_get_document</a> (c_arr, &amp;v_doc);</div>
<div class="line">  c_page = <a class="code" href="group__bson__cursor.html#ga8020ba70e4514954a5a5ebe37baa2bcb">bson_find</a> (v_doc, <span class="stringliteral">&quot;title&quot;</span>);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#ga657fb2f0fecd190b824d3e38936b1d4d">bson_cursor_get_string</a> (c_page, &amp;v_str);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c_page);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c_arr);</div>
<div class="line">  <a class="code" href="group__bson__cursor.html#gaae32a6eae2be182d26c8f2a79a07ac12">bson_cursor_free</a> (c);</div>
<div class="line"></div>
<div class="line">  printf (<span class="stringliteral">&quot;Title of the 2nd page in the pages array: %s\n&quot;</span>, v_str);</div>
</div><!-- fragment --></p>
<p>And that concludes our BSON traversing tutorial!</p>
<p><div class="fragment"><div class="line"></div>
<div class="line">  <a class="code" href="group__bson__object__access.html#ga1c0a306bfbe71d42218a3882ed188dd8">bson_free</a> (doc);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 22 2014 12:56:25 for libmongo-client by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
